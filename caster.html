<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Worlds Draft â€“ Caster</title>
<style>
body {
background:#0b0b0b;
color:#d4af37;
font-family:Arial;
padding:20px;
}
.item {
background:#1c1c1c;
padding:8px;
margin:6px 0;
cursor:pointer;
}
button {
background:#d4af37;
border:none;
padding:8px 14px;
font-weight:bold;
cursor:pointer;
}
</style>
</head>
<body>

<h1>ğŸ™ Worlds Draft â€“ Caster</h1>
<div id="info"></div>
<button onclick="undo()">ğŸ” ë˜ëŒë¦¬ê¸°</button>

<h3 id="poolTitle"></h3>
<div id="pool"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
import { get, push, update }
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
  
/* ğŸ”§ Firebase ì„¤ì • (ì•„ì§ ë¹„ì›Œë‘ ) */
const firebaseConfig = {
apiKey: "AIzaSyC1E1-vIqTBbe34LSjsbpMGnh4JLwMJycc",
authDomain: "worlds-draft.firebaseapp.com",
databaseURL: "https://worlds-draft-default-rtdb.firebaseio.com",
projectId: "worlds-draft"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ğŸ† Worlds ì˜ˆì‹œ ë°ì´í„° */
const data = {
pools: [
["JDG","GEN.G","T1","G2"],
["BLG","KT","DK","FNC"],
["LNG","WBG","NRG","C9"],
["MAD","TL","BDS","GAM"]
],
pickOrder:["A","B","B","A"],
currentPool:0,
pickIndex:0,
teamA:[],
teamB:[],
history:[]
};

function sync() {
set(ref(db,"draft"), data);
}

function render() {
document.getElementById("info").innerText =
`Pool ${data.currentPool+1} | ${data.pickIndex+1}í”½ â†’ Team ${data.pickOrder[data.pickIndex]}`;

document.getElementById("poolTitle").innerText = `Pool ${data.currentPool+1}`;
const pool=document.getElementById("pool");
pool.innerHTML="";

data.pools[data.currentPool].forEach((t,i)=>{
const d=document.createElement("div");
d.className="item";
d.innerText=t;
d.onclick=()=>pick(t,i);
pool.appendChild(d);
});

sync();
}

function pick(team,i){
const side=data.pickOrder[data.pickIndex];
data.pools[data.currentPool].splice(i,1);
data[side==="A"?"teamA":"teamB"].push(team);
data.history.push({team,side,pool:data.currentPool,pick:data.pickIndex});
data.pickIndex++;

if(data.pickIndex>=4){
data.currentPool++;
data.pickIndex=0;
}
render();
}

function undo(){
const h=data.history.pop();
if(!h) return;
data.currentPool=h.pool;
data.pickIndex=h.pick;
data.pools[h.pool].push(h.team);
data[h.side==="A"?"teamA":"teamB"].pop();
render();
}

render();
const PICK_ORDER = ["BLUE", "RED", "RED", "BLUE", "BLUE", "RED"];

function pickPlayer(playerName) {
const draftRef = ref(db, "draft");

get(draftRef).then(snapshot => {
const data = snapshot.val();
const index = data?.currentPick ?? 0;

if (index >= PICK_ORDER.length) {
alert("í”½ ì¢…ë£Œ");
return;
}

const team = PICK_ORDER[index];

push(ref(db, "draft/picks"), {
team,
player: playerName,
time: Date.now()
});

update(draftRef, {
currentPick: index + 1
});
});
}
</script>
</body>
</html>
